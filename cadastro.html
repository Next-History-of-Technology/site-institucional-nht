<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro</title>
    <link rel="stylesheet" href="./styles/cadastro.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body>
    <main class="container">
        <div class="banner-container">
            <a href="./index.html" class="link_voltar">
                <i class="fa-solid fa-arrow-up-right-from-square"></i>
                Voltar
            </a>

            <h1>Bem-vindo à
                <br>
                tela de cadastro
            </h1>
        </div>

        <div class="cadastro-container">
            <img src="./assets//Logo-nht.png" alt="Logo Next History Technology">
            <h2>Cadastre-se</h2>

            <div class="inputs-container">
                <div class="dupla-input">
                    <label>
                        Email
                        <br>

                        <div>
                            <input type="email" placeholder="Email" id="input_email" oninput="validarEmail()">
                            <span id="email_span"></span>
                        </div>
                    </label>

                    <label>
                        Nome
                        <br>

                        <div>
                            <input type="text" placeholder="Nome" id="input_nome" oninput="validarNome()">
                            <span id="nome_span"></span>
                        </div>
                    </label>
                </div>


                <div class="dupla-input">
                    <label>
                        Telefone
                        <br>

                        <div>
                            <input type="text" placeholder="Telefone" id="input_telefone" oninput="validarTelefone()"
                                maxlength="15">
                            <span id="telefone_span"></span>
                        </div>
                    </label>

                    <label>
                        CPF
                        <br>

                        <div>
                            <input type="text" placeholder="CPF" id="input_cpf" maxlength="14" oninput="validarCpf()">
                            <span id="cpf_span"></span>
                        </div>
                    </label>
                </div>


                <div class="dupla-input">
                    <label>
                        Senha
                        <br>

                        <div>
                            <input type="password" placeholder="Senha" id="input_senha" oninput="validarSenha()">
                            <span id="senha_span"></span>
                        </div>
                    </label>

                    <label>
                        Confirmar senha
                        <br>

                        <div>
                            <input type="password" placeholder="Confirme a senha" id="input_confirmar_senha"
                                oninput="validarSenhaRepetida()">
                            <span id="confirmar_senha_span"></span>
                        </div>
                    </label>
                </div>

            </div>

            <button onclick="cadastrar()">Cadastrar</button>

            <p>Já é cadastrado? <a href="./login.html">Acesse sua conta!</a></p>
        </div>
    </main>
</body>

</html>
<script>
    function cadastrar() { //Função que verifica se todos os dados estão sendo preenchidos
        var email = input_email.value
        var nome = input_nome.value
        var telefone = input_telefone.value
        var cpf = input_cpf.value
        var senha = input_senha.value
        var repetirSenha = input_confirmar_senha.value

        if (!email || !nome || !telefone || !cpf || !senha || !repetirSenha) {
            alert('Preencha os dados corretamente!')
        } else if (senha !== repetirSenha) {
            alert('As senhas precisam ser iguais!')
        }
        else {
            alert('Usuário cadastrado com sucesso!')
            window.location.href = 'login.html' //Caso esteja tudo certo, usa o window.location.href para redirecionar à tela tela de login.
        }
    }

    function validarEmail() { //Função para validar o email
        var email = input_email.value
        var contador = 0

        if (email.endsWith('sptech.school') || //Se o email terminar com algumas dessas opções, entre no loop (while)
            email.endsWith('.com') ||
            email.endsWith('.com.br')) {

            while (contador < email.length) { //Enquanto o contador for menor que o tamanho do texto
                contador++

                if (email[contador] == '@') { //Percorrendo cada posição do email do usuário para verificar se existe o caractere "@"
                    input_email.style.border = 'solid 2px #28DF99'
                    email_span.innerHTML = ''
                }

            }
        } else {
            input_email.style.border = 'solid 2px red'
            email_span.innerHTML = 'Formato de email inválido'
        }

        // while (contador < email.length) {
        //     if (email[contador] == '@' && (email.endsWith('sptech.school') ||
        //         email.endsWith('.com') ||
        //         email.endsWith('.com.br'))) {
        //         input_email.style.border = 'solid 2px #28DF99'
        //         email_span.innerHTML = ''

        //         break
        //     } else {
        //         input_email.style.border = 'solid 2px red'
        //         email_span.innerHTML = 'Formato de email inválido'
        //     }

        //     contador++
        // }
    }

    function validarNome() { //Função para verificar se é um nome válido
        var nome = input_nome.value
        var contador = 0

        while (contador < nome.length) { //Enquanto o contador for menor que o tamanho do nome
            if (nome.length <= 1) { //Se o tamanho do nome for menor ou igual a 1, o nome é inválido
                input_nome.style.border = 'solid 2px red'
                nome_span.innerHTML = 'Insira um nome válido'
            } else {
                input_nome.style.border = 'solid 2px #28DF99'
                nome_span.innerHTML = ''
            }

            contador++
        }
    }

    function validarTelefone() { //Função que verifica se o telefone é válido
        var telefone = input_telefone.value
        var contador = 0

        while (contador < 15) { //Enquanto o contador for menor que 15(Número de caracteres máximo do telefone com as formatações)
            contador++
            if (telefone.length == 15) { //Se o tamanho do telefone for igual a 15, ele é válido
                telefone_span.innerHTML = ''
                input_telefone.style.border = 'solid 2px #28DF99'
            } else {
                telefone_span.innerHTML = 'Formato de telefone inválido'
                input_telefone.style.border = 'solid 2px red'
            }
        }

        //Formatação do telefone
        if (telefone.length == 2) { //Se o tamanho do telefone for igual a dois, adiciona parênteses entre os número
            input_telefone.value = '(' + telefone + ') '
        } else if (telefone.length == 10) { //Se o tamanho do telefone for igual a 10, adiciona um traço antes dos 4 últimos números
            input_telefone.value += '-'
        }
    }

    function validarCpf() { // Função que valida o CPF
        var cpf = input_cpf.value
        var contador = 0

        while (contador < 14) { //Enquanto o contador for menor que 14(Número máximo de caracteres com a formatação do CPF)
            contador++

            if (cpf.length == 14) { //Se o tamanho do CPF inserido for igual a 14, ele é válido
                cpf_span.innerHTML = ''
                input_cpf.style.border = 'solid 2px #28DF99'
            } else {
                cpf_span.innerHTML = 'Formato de CPF inválido'
                input_cpf.style.border = 'solid 2px red'
            }

        }

        if (cpf.length == 3 || cpf.length == 7) { //Se o tamanho do CPF for igual a 3 ou igual a 7, adiciona um ponto antes dos números seguintes
            input_cpf.value += '.'
        } else if (cpf.length == 11) { //Se o tamanho do CPF inserido for igual a 11, adiciona um traço antes dos dígitos finais
            input_cpf.value += '-'
        }
    }

    function validarSenha() { //Função que valida a Senha inserida
        var senha = input_senha.value
        var contador = 0

        while (contador < senha.length) { //Enquanto o contador for menor que o tamanho da senha
            contador++

            if (senha.length < 8) { //Se o tamanho da senha for menor que 8 caracteres, ela não será válida
                senha_span.innerHTML = 'Senha necessita de, no mínimo, 8 caracteres'
                input_senha.style.border = 'solid 2px red'
            } else {
                senha_span.innerHTML = ''
                input_senha.style.border = 'solid 2px #28DF99'
            }
        }
    }

    function validarSenhaRepetida() { //Função que valida a senha repetida
        var senha = input_senha.value
        var senhaRepetida = input_confirmar_senha.value

        if (senhaRepetida !== senha || senhaRepetida.length < 8) { //Se as senhas forem diferentes ou se o tamanho da senha repetida for menor que 8, a senha repetida será inválida
            confirmar_senha_span.innerHTML = 'As senhas precisam ser iguais'
            input_confirmar_senha.style.border = 'solid 2px red'
        } else {
            confirmar_senha_span.innerHTML = ''
            input_confirmar_senha.style.border = 'solid 2px #28DF99'
        }
    }
</script>